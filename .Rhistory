library(circlize)
df <- read.csv(file="chords.csv",sep=";",head=F)
chordDiagramFromDataFrame(df,)
chordDiagramFromDataFrame(df,reduce=20)
chordDiagramFromDataFrame(df, 1e-2)
chordDiagramFromDataFrame(df, 1e-1)
chordDiagramFromDataFrame(df, reduce=1e-1,annotationTrack=NULL)
chordDiagramFromDataFrame(df, reduce=1e-1)
chordDiagramFromDataFrame(df, reduce=1e-5)
chordDiagramFromDataFrame(df, reduce=1e-10)
chordDiagramFromDataFrame(df, reduce=1e-100)
chordDiagramFromDataFrame(df, reduce=1e-2)
chordDiagramFromDataFrame(df, reduce=1e-3)
chordDiagramFromDataFrame(df, reduce=1e-4)
chordDiagramFromDataFrame(df, reduce=1e-5)
subset
min(df$V3)
mean(df$V3)
df2 <- subset(df,df$V3 > 20)
chordDiagramFromDataFrame(df2)
df2 <- subset(df,df$V3 > 50)
chordDiagramFromDataFrame(df2)
df2 <- subset(df,df$V3 > 100)
chordDiagramFromDataFrame(df2)
circos.trackPlotRegion(track.index = 1, panel.fun = function(x, y) {
  xlim = get.cell.meta.data("xlim")
  ylim = get.cell.meta.data("ylim")
  sector.name = get.cell.meta.data("sector.index")
  circos.text(mean(xlim), ylim[1] + .1, sector.name, facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5))
  circos.axis(h = "top", labels.cex = 0.5, major.tick.percentage = 0.2, sector.index = sector.name, track.index = 2)
}, bg.border = NA)
chordDiagramFromDataFrame(df2,annotationTrack = "grid", preAllocateTracks = 1,)
circos.trackPlotRegion(track.index = 1, panel.fun = function(x, y) {
  xlim = get.cell.meta.data("xlim")
  ylim = get.cell.meta.data("ylim")
  sector.name = get.cell.meta.data("sector.index")
  circos.text(mean(xlim), ylim[1] + .1, sector.name, facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5))
  circos.axis(h = "top", labels.cex = 0.5, major.tick.percentage = 0.2, sector.index = sector.name, track.index = 2)
}, bg.border = NA)
chordDiagramFromDataFrame(df2,annotationTrack = "grid", preAllocateTracks = 1,)
circos.trackPlotRegion(track.index = 1, panel.fun = function(x, y) {
  xlim = get.cell.meta.data("xlim")
  ylim = get.cell.meta.data("ylim")
  sector.name = get.cell.meta.data("sector.index")
  circos.text(mean(xlim), ylim[1] + .1, sector.name, facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5))
  circos.axis(h = "top", labels.cex = 0.5, major.tick.percentage = 0.2, sector.index = sector.name, track.index = 2)
}, bg.border = NA)
chordDiagramFromDataFrame(df2,annotationTrack = "grid", preAllocateTracks = 1,)
circos.trackPlotRegion(track.index = 1, panel.fun = function(x, y) {
  xlim = get.cell.meta.data("xlim")
  ylim = get.cell.meta.data("ylim")
  sector.name = get.cell.meta.data("sector.index")
  circos.text(mean(xlim), ylim[1] + .1, sector.name, facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5))
  circos.axis(h = "top", labels.cex = 0.5, major.tick.percentage = 0.2, sector.index = sector.name, track.index = 2)
}, bg.border = NA)
df2 <- subset(df,df$V3 > 100)
chordDiagramFromDataFrame(df2,annotationTrack = "grid", preAllocateTracks = 1,)
df2 <- subset(df,df$V3 > 200)
chordDiagramFromDataFrame(df2,annotationTrack = "grid", preAllocateTracks = 1,)
chordDiagramFromDataFrame(df2,annotationTrack = "grid", preAllocateTracks = 1,)
circos.trackPlotRegion(track.index = 1, panel.fun = function(x, y) {
  xlim = get.cell.meta.data("xlim")
  ylim = get.cell.meta.data("ylim")
  sector.name = get.cell.meta.data("sector.index")
  circos.text(mean(xlim), ylim[1] + .1, sector.name, facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5))
  circos.axis(h = "top", labels.cex = 0.5, major.tick.percentage = 0.2, sector.index = sector.name, track.index = 2)
}, bg.border = NA)
df2 <- subset(df,df$V3 > 300)
chordDiagramFromDataFrame(df2,annotationTrack = "grid", preAllocateTracks = 1,)
circos.trackPlotRegion(track.index = 1, panel.fun = function(x, y) {
  xlim = get.cell.meta.data("xlim")
  ylim = get.cell.meta.data("ylim")
  sector.name = get.cell.meta.data("sector.index")
  circos.text(mean(xlim), ylim[1] + .1, sector.name, facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5))
  circos.axis(h = "top", labels.cex = 0.5, major.tick.percentage = 0.2, sector.index = sector.name, track.index = 2)
}, bg.border = NA)
pdf("SampleGraph.pdf",width=7,height=7)
chordDiagramFromDataFrame(df2,annotationTrack = "grid", preAllocateTracks = 1,)
circos.trackPlotRegion(track.index = 1, panel.fun = function(x, y) {
  xlim = get.cell.meta.data("xlim")
  ylim = get.cell.meta.data("ylim")
  sector.name = get.cell.meta.data("sector.index")
  circos.text(mean(xlim), ylim[1] + .1, sector.name, facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5))
  circos.axis(h = "top", labels.cex = 0.5, major.tick.percentage = 0.2, sector.index = sector.name, track.index = 2)
}, bg.border = NA)
dev.off()
q()
